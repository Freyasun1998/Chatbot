<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <title>An Interesting & Dramatic Chatbot</title>

  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <link href="/docs/5.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

  <!-- Favicons -->

  <!-- Custom styles for this template -->
  <link href="style/styles.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

</head>

<body>

  <!-- Navbar -->
  <div class="container" style="max-width: 800px">

    <h2 style='text-align: center; font-family: "Lucida Handwriting", "Brush Script MT", cursive;'>An Interesting & Dramatic Chatbot</h2>
    <br>
    <p style='font-size: 20px; text-align: right; font-family: "Times New Roman", Times, serif;'>
      Final Project of ANLY580 <br>
      Natural Language Processing <br>
      at Georgetown University</p>
    
    <hr style=" border-top: 8px solid #bbb; border-radius: 5px;">
    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>An Introduction to Chatbots</strong>
    </h4>
    <div class="row py-5">
    
              <div class="col-md-12">
                <div class="card p-0" style="border: none">
                  <img src="imgs/introduction.png" style="margin:auto;" alt="..." width="500">
                  <div class="card-body">
                    <p style="font-weight: lighter; text-align: center;">How Chatbot Works</p>
    
                  </div>
                </div>
              </div>
    </div>
    <p>
      <strong>Chatbots</strong> 
      generally represent for the software applications which can 
      carry out live conversations with users' utterances in the form of text or audio. 
      While a lot of research has been done on chatbots for the theories and engineering techniques, 
      a number of chatbot applications have been also developed in different settings.
      The chatbots could be divided into different categories according to the usage and principles behind,
      among which some popular ones are:
    </p>
    <ul>
      <li><strong>Customer Service Chatbots:</strong> Carry out Q&As and provide service options
      for the customers. Typical examples are customer service chatbots of e-commerce companies,
      such as <strong>Amazon</strong> and <strong>Ebay</strong>.</li>
      <li><strong>Task Oriented Chatbots:</strong> Answer questions and have the ability to
        complete specific tasks, such as scheduling appointments and making calls. 
        Two typical examples are <strong>Siri</strong> from <strong>Apple</strong> and 
        <strong>Cortana</strong> from <strong>Microsoft</strong>.</li>
      <li><strong>Open Domain Chatbots:</strong> Chat with users in turns in an open domain, not 
      restricted to specific tasks, sometimes within certain topics. </li>
    </ul>
    <br>
    <hr>
    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Project Goals</strong>
    </h4>
    <br>
    <p>
      For our project, we place our interests and efforts on the open-domain chatbots.
      We expect to build an open-domain chatbot with dramatic responses,
      which has the ability of 'chatting' with the user in an interesting and interactive way.

    </p>
    <p>
      Our basic idea is first load the open-source pre-trained models of <strong>DialoGPT</strong>,
      which are from microsoft and trained primarily on twits and reddits.
      Then we finetune the model on the movie dialogue corpus, 
      in the assumption that conversations in movies tend to be more dramatic and 
      emotional, different from common conversations with more apparent features that is easy for us to build models, specifically tweets and reddits. 
      We finally deploy the chatbots using google voice API. More technical details are provided in the
      following parts.
    </p>
    <p>
      Anyway, we simply want to give the user a surprise, a sense of happiness, 
      and a relief temporarily from the heavy everyday work and studies.
    </p>
    <br>
    <hr>

    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Pre-trained Model</strong>
    </h4>
    <br>
            <p><strong>DialoGPT</strong> from <strong>microsoft</strong></p>
            <p> Model link from <strong>huggingface</strong>: <a href="https://huggingface.co/microsoft/DialoGPT-medium">microsoft/DialoGPT</a></p>
            <ul>
              <li>Establishes a foundation for building versatile open-domain chatbots that can deliver natural conversational responses across various conversational topics.</li>
              <li>Formulated as an autoregressive (AR) language model, uses a multi-layer transformer as model architecture, and draws on 147M multi-turn dialogues extracted from Reddit discussion threads.</li>
              <li>Responses approach human-level response quality in a single-turn Turing test.</li>
            </ul>
    <br>
    <hr>
    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>DataSet</strong>
    </h4>
        <br>
            <p><strong>Movie Dialogue Corpus</strong></p>
            <p>
              The corpus contains a metadata-rich collection of fictional conversations extracted from raw movie scripts:
            </p>
            <p>
              <a href="https://www.kaggle.com/datasets/Cornell-University/movie-dialog-corpus">movie-dialog-corpus-kaggle-link</a>
            </p>
            <ul>
              <li>
                220,579 conversational exchanges between 10,292 pairs of movie characters
              </li>
              <li>
                involves 9,035 characters from 617 movies
              </li>
              <li>
                in total 304,713 utterances
              </li>
            </ul>
    <br>
    <hr>
    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Data Cleaning</strong>
    </h4>
            <br>
            <ul>
              <li>
                Join the csv files and get all the conversations in movies tagged by 'comedy'.
              </li>
              <li>
                Filter out meanless sentences such as 'Yes.', 'No.', 'I don't know', 'I'm sorry',
                which take a large part of original dataset and can lead to unwanted fintuning results.
              </li>
              <li>
                Filter out all sentences with length under 10, which are low-quality conversations.
              </li>
            </ul>
        <br>
        <hr>

    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Fine-tuning</strong>
    </h4>
        <br>
            <p>
              <strong>Hardware Support for Training:</strong>
            </p>
            <ul>
              <li>
                Colab Pro+ & extra 300 compute units($50 per month + extra $30)(500+300 compute units)
              </li>
              <li>
                Google One ($2 per month)(100 GB storage)
              </li>
              <li>
                Intel i7-10750H (RAM 16GB)
              </li>
            </ul>
            <br>
            <p>
              <strong>Finetuning Time:</strong>(Epochs:2 Batch_size:4)
            </p>
            <ul>
              <li>
                DialoGPT-small: Around 35min
              </li>
              <li>
                DialoGPT-medium: Around 1h 20min
              </li>
              <li>
                DialoGPT-large: Around 2h 15min
              </li>
            </ul>
            <br>
            <p>
              <strong>Loss Visualization:</strong>(Screenshots of Tensorboard)
            </p>
            <!-- IMAGE: body length comparison -->
            <div class="row py-5">

              <div class="col-md-12">
                <div class="card p-0" style="border: none">
                  <img src="imgs/loss-medium.jpg" class="card-img-top" alt="...">
                  <div class="card-body">
                    <p style="font-weight: lighter; text-align: center;"><b>Screenshot:</b> Loss Record of Medium-Size Model Finetuning</p>

                  </div>
                </div>
              </div>
            </div>
            <!-- IMAGE END -->
    <br>
    <hr>

    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Demo</strong>
    </h4>
    <p>Let's see a demo first.</p>
    <div class="row py-5">
    
      <div class="col-md-12">
        <div class="card p-0" style="border: none">
          <video width="250" style="margin:auto;" controls >
            <source src="demos/demo1.mp4"  type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <div class="card-body">
            <p style="font-weight: lighter; text-align: center;">An Interesting Demo</p>

          </div>
        </div>
      </div>
    </div>
    <p>Well, while this is our chatbot of the 'first generation', it chats with us as our SweetHeart!</p>

    <br>
    <hr>
    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>More Interactions</strong>
    </h4>
    <br>
    <p>After we improve our data-cleaning & finetuning process and have
      more trials for the hyper-parameters, our SweetHeart 
      becomes more interesting and interactive.
      And we have more interesting interactions with our SweetHeart:</p>

    <table style="margin:auto;">
      <tr>
        <td>
          <div class="row py-5">
            <div class="col-md-12">
              <div class="card p-0" style="border: none">
                <img src="imgs/Screenshot1.jpg" width='200px' style="margin:auto;" alt="...">
              </div>
            </div>
          </div>
        </td>

        <td>
          <div class="row py-5">
            <div class="col-md-12">
              <div class="card p-0" style="border: none">
                <img src="imgs/Screenshot2.jpg" width='200px' style="margin:auto;" alt="...">
              </div>
            </div>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="row py-5">
            <div class="col-md-12">
              <div class="card p-0" style="border: none">
                <img src="imgs/Screenshot3.jpg" width='200px' style="margin:auto;" alt="..." >
              </div>
            </div>
          </div>
        </td>
        <td>
          <div class="row py-5">
            <div class="col-md-12">
              <div class="card p-0" style="border: none">
                <img src="imgs/Screenshot4.jpg" width='200px' style="margin:auto;" alt="..." >
              </div>
            </div>
          </div>
        </td>
      </tr>
    </table>
    <div class="card-body">
      <p style="font-weight: lighter; text-align: center;">Screenshots of More Interesting Interactions</p>

    </div>
    <br>
    <p>
      We interact with our SweetHeart using common sentences, philosophical questions, quotes of Darks Souls & 
      Elden Ring, poems by Load Byron. And in reply our SweetHeart presents us with some surprises!
    </p>
    <p>
      While original DialoGPT tends to give longer replies as illustrations to the question 
      'What's the meaning of Life?', our chatbot tends to reply in a short and smart way, which 
      is expected in movie conversations.
    </p>
    <br>
    <hr>
    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Conclusions</strong>
    </h4>
    <br>
    <p>
      Above is all about our NLP final project regarding building a chatbot. 
      Although our SweetHeart chatbot interacts with us as what we've expected, 
      more complex structures and more advanced techniques can be applied to our chatbot in the future.
    </p>
    <p>
      There is a famous and instructive quote from <strong>Dr. Seuss</strong>:
    </p>
    <p style="font-family: cursive;">
       The more that you read, the more things you will know.<br>
        The more that you learn, the more places you’ll go.
    </p>
    <p>
      While our chatbot has learned from the movie conversations, 
      it is expected that it can learn from daily conversations which have less features and interacted as real. 
      We ourselves also need to keep learning from more papers and applications, 
      in the hope to improve our lovely chatbot and build more interesting and elegant models in the future.
    </p>
    <br>
    <hr>

    <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Future Work</strong>
    </h4>
    <br>
    <p>Beside what we have done so far, there still have some things we need to do in the future to improve the performance of our model. For the method we used this time, it is just simply shuffling the training dataset. It may perform much better if we try state-of-the-art planning strategies. Also, if we finetune on larger datasets that balanced and explicitly in some certain utterance style, the quality of reply of our chatbot can be higher. What is more, the reply from our model contains a lots of adversarial or meaningless sentences. So we need to find a solution to filter those unwanted replies.</p>
    <br>
    <hr>

        <h4 style='font-family: "Times New Roman", Times, serif;'>
      <strong>Links</strong>
    </h4>
            <br>
            <ul>
              <li>
                <a href="https://github.com/kianakaslana648/nlp-final-project">Github Repo</a> for tutorial of data cleaning,
            finetuning and deploying.
              </li>
              <li>
                <a href="https://huggingface.co/Kiana648/movie_dialogue_gpt2">Huggingface Page</a> for the finetuned model(in medium size).
              </li>
            </ul>
    


    
  </div> <!-- container -->
  <footer class="blog-footer">
    <p>
      <a href="#">Back to top</a>
    </p>
  </footer>

</body>

</html>
